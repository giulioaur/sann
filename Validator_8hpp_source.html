<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SANN: Sushi Artificial Neural Network: sann/Validator.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SANN: Sushi Artificial Neural Network
   </div>
   <div id="projectbrief">This is a short library for a simple but efficient neural network</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a3fcf4f04c4ad3880a84d67980a00cfb.html">sann</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Validator.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*******************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *                                                     *</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  sann: Neural Network library                       *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                                                     *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  VALIDATOR CLASS HEADER                             *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *                                                     *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  Giulio Auriemma                                    *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *                                                     *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *******************************************************/</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#ifndef S_VALIDATOR_S</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#define S_VALIDATOR_S</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// System include library.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// My includes.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;constants.h&quot;</span> </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;dataStructures.h&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;Network.hpp&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;utility/FileManager.hpp&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> MAX_DOUBLE = std::numeric_limits&lt;double&gt;::max();</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesann.html">sann</a>{</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// It exploits grid search and cross validation for a complete validation phase.</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="classsann_1_1Validator.html">   32</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsann_1_1Validator.html">Validator</a>{</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">//CLASSES</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    </div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classsann_1_1Validator_1_1TrValidEstimator.html">   53</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classsann_1_1Validator_1_1TrValidEstimator.html">TrValidEstimator</a> : <span class="keyword">public</span> <a class="code" href="classsann_1_1Estimator.html">Estimator</a>{</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordtype">bool</span> earlyStop = <span class="keyword">false</span>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        std::size_t epoch, oldEpoch;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        std::string filename, results = <span class="stringliteral">&quot;&quot;</span>, oldResults;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordtype">double</span> oldError, oldAccuracy;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keyword">protected</span>:</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordtype">double</span> accuracy, error = 1, errorThreshold = 10e-7;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="classsann_1_1Validator_1_1TrValidEstimator.html">TrValidEstimator</a>(<span class="keyword">const</span> std::string &amp;filename) : filename(filename) {}</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keyword">virtual</span> std::unique_ptr&lt;TrValidEstimator&gt; clone(<span class="keyword">const</span> std::string &amp;filename) <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> init(<span class="keyword">const</span> std::size_t epoch){</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            this-&gt;accuracy = this-&gt;error = 0; this-&gt;epoch = epoch;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            this-&gt;results += std::to_string(epoch) + <span class="charliteral">&#39;,&#39;</span>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">bool</span> stoppingCriteria(){ <span class="keywordflow">return</span> this-&gt;error &lt;= errorThreshold || earlyStop; }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> finalize() = 0;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordtype">void</span> plot(){</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            this-&gt;finalize();</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            this-&gt;results += std::to_string(error) + <span class="charliteral">&#39;,&#39;</span> + std::to_string(accuracy) + <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordtype">void</span> terminate(){</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordflow">if</span>(this-&gt;earlyStop){</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <a class="code" href="classsann_1_1utility_1_1FileManager.html#af3d5d24e845f02a2646a5569a97ed66d">utility::FileManager::writeFile</a>(FILES_DIR + <span class="stringliteral">&quot;validation/&quot;</span> + filename + <span class="stringliteral">&quot;.csv&quot;</span>, this-&gt;oldResults);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                this-&gt;epoch = this-&gt;oldEpoch;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                <a class="code" href="classsann_1_1utility_1_1FileManager.html#af3d5d24e845f02a2646a5569a97ed66d">utility::FileManager::writeFile</a>(FILES_DIR + <span class="stringliteral">&quot;validation/&quot;</span> + filename + <span class="stringliteral">&quot;.csv&quot;</span>, this-&gt;results);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">double</span> getAccuracy()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> this-&gt;earlyStop ? this-&gt;oldAccuracy : this-&gt;accuracy; }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">double</span> getError()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> this-&gt;earlyStop ? this-&gt;oldError : this-&gt;error; }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">double</span> getEpoch()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> this-&gt;earlyStop ? this-&gt;oldEpoch : this-&gt;epoch; }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordtype">void</span> setEarlyStop(){ this-&gt;earlyStop = <span class="keyword">true</span>; }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">void</span> saveResults(){ </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            this-&gt;oldResults = this-&gt;results; this-&gt;oldEpoch = this-&gt;epoch; </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            this-&gt;oldError = this-&gt;error; this-&gt;oldAccuracy = this-&gt;accuracy;    </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    };</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classsann_1_1Validator_1_1VdValidEstimator.html">  102</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classsann_1_1Validator_1_1VdValidEstimator.html">VdValidEstimator</a> : <span class="keyword">public</span> <a class="code" href="classsann_1_1Estimator.html">Estimator</a>{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="classsann_1_1Validator_1_1TrValidEstimator.html">TrValidEstimator</a> &amp;trEst;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        std::size_t currIteration = 0, epoch;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">double</span> oldError = MAX_DOUBLE, oldAccuracy = MAX_DOUBLE;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">protected</span>:</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        std::size_t earlyStep = 2, earlyThreshold = 1000;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordtype">double</span> error, accuracy, errorThreshold = 0.2;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classsann_1_1Validator_1_1VdValidEstimator.html">VdValidEstimator</a>(<a class="code" href="classsann_1_1Validator_1_1TrValidEstimator.html">TrValidEstimator</a> &amp;trEst) : trEst(trEst){}</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keyword">virtual</span> std::unique_ptr&lt;VdValidEstimator&gt; clone(<a class="code" href="classsann_1_1Validator_1_1TrValidEstimator.html">TrValidEstimator</a> &amp;trEst) <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> init(<span class="keyword">const</span> std::size_t epoch){</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            this-&gt;accuracy = this-&gt;error = 0; this-&gt;epoch = epoch;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordtype">bool</span> stoppingCriteria(){ <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> finalize() = 0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">void</span> plot(){ </div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            this-&gt;finalize();</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="comment">// Each n epoch check if the mse is decreasing. If so, init current iteration to 0.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">if</span>(this-&gt;epoch % this-&gt;earlyStep == 0){</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <span class="keywordflow">if</span>(this-&gt;error &lt; this-&gt;oldError){</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    this-&gt;oldError = this-&gt;error; this-&gt;oldAccuracy = this-&gt;accuracy;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    this-&gt;currIteration = 0;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    this-&gt;trEst.saveResults();</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(this-&gt;error - this-&gt;oldError &gt; errorThreshold){</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    this-&gt;currIteration++;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            }   </div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="comment">// If the number of iteration since mse decresed is more than the threshold, set the</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="comment">// earlystop attribute of the training estimator to true.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">if</span>(this-&gt;currIteration &gt;= this-&gt;earlyThreshold) </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                this-&gt;trEst.setEarlyStop();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> terminate(){ }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordtype">size_t</span> getEpoch(){ <span class="keywordflow">return</span> this-&gt;epoch; }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    };</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// ATTRIBUTES</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    std::function&lt;double(const std::vector&lt;double&gt;&amp;, <span class="keyword">const</span> std::vector&lt;double&gt;&amp;)&gt; loss;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    std::vector&lt;std::function&lt;std::vector&lt;weightsMatrix&gt; (std::vector&lt;std::size_t&gt;)&gt;&gt; initializers = {};</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    std::vector&lt;size_t&gt; epochs = {};</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::vector&lt;float&gt; taus = {}, alphas = {}, lambdas = {};</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    std::vector&lt;std::vector&lt;float&gt;&gt; etas;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    std::vector&lt;Network&gt; nets = {};</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    std::size_t initNum = 1;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keyword">const</span> std::shared_ptr&lt;TrValidEstimator&gt; trainingEst;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keyword">const</span> std::shared_ptr&lt;VdValidEstimator&gt; validationEst;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// STRUCTS</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">struct </span>pars_container{</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="structsann_1_1p.html">parameters</a> pars = {};</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">double</span> valError = MAX_DOUBLE, accuracy = 0, trainError = MAX_DOUBLE;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordtype">float</span> tau, eta0, etat;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordtype">bool</span> operator &lt; (<span class="keyword">const</span> pars_container&amp; other){</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">return</span> valError &lt; other.valError || (valError == other.valError &amp;&amp; </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    (accuracy &gt; other.accuracy || (accuracy == other.accuracy &amp;&amp; trainError &lt; other.trainError)));</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    };</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// METHODS</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::string getValidatorName(<a class="code" href="classsann_1_1Network.html">sann::Network</a> &amp;net, <span class="keyword">const</span> <a class="code" href="structsann_1_1p.html">sann::parameters</a> &amp;hyperP, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;etaDecay) <span class="keyword">const</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    pars_container gridSearch(<a class="code" href="classsann_1_1Network.html">sann::Network</a> &amp;net, <span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;tr, <span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;vs) <span class="keyword">const</span>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    pars_container modelSearch(<span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;tr, <span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;vs, <a class="code" href="classsann_1_1Network.html">Network</a> &amp;net) <span class="keyword">const</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    pars_container modelCrossSearch(<span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;trSet, <span class="keyword">const</span> <span class="keywordtype">size_t</span> sets, <a class="code" href="classsann_1_1Network.html">Network</a> &amp;net) <span class="keyword">const</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// TYPEDEF</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keyword">typedef</span> std::function&lt;double(const std::vector&lt;double&gt;&amp;, <span class="keyword">const</span> std::vector&lt;double&gt;&amp;)&gt; loss_func;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">typedef</span> std::function&lt;std::vector&lt;weightsMatrix&gt; (std::vector&lt;std::size_t&gt;)&gt; initializer;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// ENUMERATION</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">enum</span> msParameter{EPOCH, TAU, ETAS, MOMENTUM, REGULARIZATION};</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// STRUCT</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="structsann_1_1Validator_1_1container.html">  192</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structsann_1_1Validator_1_1container.html">container</a>{</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="classsann_1_1Network.html">Network</a> model;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordtype">double</span> risk;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    };</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">//CONSTRUCTORS</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// Default constructor</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="classsann_1_1Validator.html">Validator</a>(<span class="keyword">const</span> loss_func &amp;loss, <span class="keyword">const</span> std::shared_ptr&lt;TrValidEstimator&gt; trainingEst, </div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keyword">const</span> std::shared_ptr&lt;VdValidEstimator&gt; validationEst);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// Copy constructor.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classsann_1_1Validator.html">Validator</a>(<span class="keyword">const</span> <a class="code" href="classsann_1_1Validator.html">Validator</a> &amp;val);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// METHODS</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classsann_1_1Validator.html#a39dd7a3658148b2e2de7e466ab6b867f">addModelSelectionParameters</a>(<span class="keyword">const</span> Validator::msParameter type, <span class="keyword">const</span> std::vector&lt;float&gt; &amp;val);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classsann_1_1Validator.html#a742255eafb9f6d4a642ec0e5fda1f6e1">addModelSelectionNetwork</a>(<span class="keyword">const</span> std::vector&lt;Network&gt; &amp;nets);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classsann_1_1Validator.html#a6213e7f814ae09e4789bb13c73b4fbab">addModelSelectionWeightInit</a>(<span class="keyword">const</span> std::vector&lt;initializer&gt; &amp;initializers);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classsann_1_1Validator.html#ad8545eb1fd543dee5c865a9847060deb">setRandomInit</a>(<span class="keyword">const</span> std::size_t n);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classsann_1_1Validator.html#ae463b3f6ef759d036a975adbb9bf326a">expectedRisk</a>(<a class="code" href="classsann_1_1Network.html">sann::Network</a> &amp;net, <span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;vs) <span class="keyword">const</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classsann_1_1Network.html">Network</a> <a class="code" href="classsann_1_1Validator.html#a6fc0173c2040d84a04cb83a64e5c3a52">selectModel</a>(<span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;tr, <span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;vs, <a class="code" href="classsann_1_1Estimator.html">sann::Estimator</a> &amp;est) <span class="keyword">const</span>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classsann_1_1Network.html">Network</a> <a class="code" href="classsann_1_1Validator.html#a607a55c4962ce3a3b822f34ec89199d5">selectModelWithCross</a>(<span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;trainingSet, <a class="code" href="classsann_1_1Estimator.html">sann::Estimator</a> &amp;est, <span class="keyword">const</span> std::size_t numOfSet = 4) <span class="keyword">const</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// The difference between the two following methods is that the first one uses simple model selection, while</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// the second one uses the k-fold cross validation for the model selection.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="structsann_1_1Validator_1_1container.html">Validator::container</a> <a class="code" href="classsann_1_1Validator.html#a48be5420b3e8907f656b01005667ba9f">selectModelWithRisk</a>(<span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;trainingSet, <span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;validationSet, </div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;testSet, <a class="code" href="classsann_1_1Estimator.html">sann::Estimator</a> &amp;trainEst, <a class="code" href="classsann_1_1Estimator.html">sann::Estimator</a> &amp;testEst) <span class="keyword">const</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="structsann_1_1Validator_1_1container.html">Validator::container</a> <a class="code" href="classsann_1_1Validator.html#a48be5420b3e8907f656b01005667ba9f">selectModelWithRisk</a>(<span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;trainingSet, <span class="keyword">const</span> <a class="code" href="structsann_1_1ds.html">sann::dataSet</a> &amp;testSet, </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="classsann_1_1Estimator.html">sann::Estimator</a> &amp;trainEst, <a class="code" href="classsann_1_1Estimator.html">sann::Estimator</a> &amp;testEst, <span class="keyword">const</span> <span class="keywordtype">size_t</span> numOfSet) <span class="keyword">const</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;};</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classsann_1_1Validator_html_a742255eafb9f6d4a642ec0e5fda1f6e1"><div class="ttname"><a href="classsann_1_1Validator.html#a742255eafb9f6d4a642ec0e5fda1f6e1">sann::Validator::addModelSelectionNetwork</a></div><div class="ttdeci">void addModelSelectionNetwork(const std::vector&lt; Network &gt; &amp;nets)</div><div class="ttdoc">Add nets structures for the testing. </div><div class="ttdef"><b>Definition:</b> Validator.cpp:103</div></div>
<div class="ttc" id="classsann_1_1Validator_html_ae463b3f6ef759d036a975adbb9bf326a"><div class="ttname"><a href="classsann_1_1Validator.html#ae463b3f6ef759d036a975adbb9bf326a">sann::Validator::expectedRisk</a></div><div class="ttdeci">double expectedRisk(sann::Network &amp;net, const sann::dataSet &amp;vs) const</div><div class="ttdoc">Computes the expected risk approximating it to the empirical risk. </div><div class="ttdef"><b>Definition:</b> Validator.cpp:59</div></div>
<div class="ttc" id="classsann_1_1utility_1_1FileManager_html_af3d5d24e845f02a2646a5569a97ed66d"><div class="ttname"><a href="classsann_1_1utility_1_1FileManager.html#af3d5d24e845f02a2646a5569a97ed66d">sann::utility::FileManager::writeFile</a></div><div class="ttdeci">static void writeFile(const std::string &amp;filename, const std::string &amp;content, const bool append=false)</div><div class="ttdoc">Write a string on a file. If the file does not exist, it will be created. </div><div class="ttdef"><b>Definition:</b> FileManager.cpp:150</div></div>
<div class="ttc" id="structsann_1_1Validator_1_1container_html"><div class="ttname"><a href="structsann_1_1Validator_1_1container.html">sann::Validator::container</a></div><div class="ttdoc">A struct returned by model assesment: it contains the model plus the risk. </div><div class="ttdef"><b>Definition:</b> Validator.hpp:192</div></div>
<div class="ttc" id="structsann_1_1ds_html"><div class="ttname"><a href="structsann_1_1ds.html">sann::ds</a></div><div class="ttdoc">This is the struct that represents the dataset to handle. It has three attributes: ...</div><div class="ttdef"><b>Definition:</b> dataStructures.h:27</div></div>
<div class="ttc" id="classsann_1_1Validator_html_a607a55c4962ce3a3b822f34ec89199d5"><div class="ttname"><a href="classsann_1_1Validator.html#a607a55c4962ce3a3b822f34ec89199d5">sann::Validator::selectModelWithCross</a></div><div class="ttdeci">Network selectModelWithCross(const sann::dataSet &amp;trainingSet, sann::Estimator &amp;est, const std::size_t numOfSet=4) const</div><div class="ttdoc">Returns the best model using cross validation. The model selection is executed using the parameters s...</div><div class="ttdef"><b>Definition:</b> Validator.cpp:316</div></div>
<div class="ttc" id="classsann_1_1Validator_1_1TrValidEstimator_html"><div class="ttname"><a href="classsann_1_1Validator_1_1TrValidEstimator.html">sann::Validator::TrValidEstimator</a></div><div class="ttdoc">Those classes are a base class for Estimators that exploit the early stop criteria. They are abstract class, so they need to be extended by another class to be instantiated. The aim of this behaviour is to allow the user to use different kind of error on different model selection. The error is the error computed during the training, not the loss of the Validator, that is specified on creation. They will be passed to the training method. NB: The model selection is better done if the error plotted by those estimator and the one minimized by the networks is the same. </div><div class="ttdef"><b>Definition:</b> Validator.hpp:53</div></div>
<div class="ttc" id="classsann_1_1Validator_html_ad8545eb1fd543dee5c865a9847060deb"><div class="ttname"><a href="classsann_1_1Validator.html#ad8545eb1fd543dee5c865a9847060deb">sann::Validator::setRandomInit</a></div><div class="ttdeci">void setRandomInit(const std::size_t n)</div><div class="ttdoc">Set the number of time every net should be initialized again with new starting values. Each set of sv is computed using once of the functions setted with method addModelSelectionWeightInit(). To be sure that all the functions are used at least once, set n &gt; the number of functions added. The sv already setted in the net when passed to model selector will be used once. </div><div class="ttdef"><b>Definition:</b> Validator.cpp:124</div></div>
<div class="ttc" id="classsann_1_1Validator_html_a39dd7a3658148b2e2de7e466ab6b867f"><div class="ttname"><a href="classsann_1_1Validator.html#a39dd7a3658148b2e2de7e466ab6b867f">sann::Validator::addModelSelectionParameters</a></div><div class="ttdeci">void addModelSelectionParameters(const Validator::msParameter type, const std::vector&lt; float &gt; &amp;val)</div><div class="ttdoc">Adds a new set of value on which search for the best model. NB: When the etas parameters (for learnin...</div><div class="ttdef"><b>Definition:</b> Validator.cpp:79</div></div>
<div class="ttc" id="classsann_1_1Validator_1_1VdValidEstimator_html"><div class="ttname"><a href="classsann_1_1Validator_1_1VdValidEstimator.html">sann::Validator::VdValidEstimator</a></div><div class="ttdef"><b>Definition:</b> Validator.hpp:102</div></div>
<div class="ttc" id="structsann_1_1p_html"><div class="ttname"><a href="structsann_1_1p.html">sann::p</a></div><div class="ttdoc">The parameters object. It holds all the settable hyper-parameters: </div><div class="ttdef"><b>Definition:</b> dataStructures.h:78</div></div>
<div class="ttc" id="classsann_1_1Estimator_html"><div class="ttname"><a href="classsann_1_1Estimator.html">sann::Estimator</a></div><div class="ttdef"><b>Definition:</b> Estimator.hpp:28</div></div>
<div class="ttc" id="classsann_1_1Validator_html_a48be5420b3e8907f656b01005667ba9f"><div class="ttname"><a href="classsann_1_1Validator.html#a48be5420b3e8907f656b01005667ba9f">sann::Validator::selectModelWithRisk</a></div><div class="ttdeci">Validator::container selectModelWithRisk(const sann::dataSet &amp;trainingSet, const sann::dataSet &amp;validationSet, const sann::dataSet &amp;testSet, sann::Estimator &amp;trainEst, sann::Estimator &amp;testEst) const</div><div class="ttdoc">Select a model and then compute the estimation risk using a test set. </div><div class="ttdef"><b>Definition:</b> Validator.cpp:336</div></div>
<div class="ttc" id="namespacesann_html"><div class="ttname"><a href="namespacesann.html">sann</a></div><div class="ttdef"><b>Definition:</b> constants.h:15</div></div>
<div class="ttc" id="classsann_1_1Validator_html_a6213e7f814ae09e4789bb13c73b4fbab"><div class="ttname"><a href="classsann_1_1Validator.html#a6213e7f814ae09e4789bb13c73b4fbab">sann::Validator::addModelSelectionWeightInit</a></div><div class="ttdeci">void addModelSelectionWeightInit(const std::vector&lt; initializer &gt; &amp;initializers)</div><div class="ttdoc">Set a new weight initializer. </div><div class="ttdef"><b>Definition:</b> Validator.cpp:112</div></div>
<div class="ttc" id="classsann_1_1Network_html"><div class="ttname"><a href="classsann_1_1Network.html">sann::Network</a></div><div class="ttdoc">This is the core class, that represents the whole Neural Network. </div><div class="ttdef"><b>Definition:</b> Network.hpp:26</div></div>
<div class="ttc" id="classsann_1_1Validator_html"><div class="ttname"><a href="classsann_1_1Validator.html">sann::Validator</a></div><div class="ttdoc">This is the class for the validation phase. It is used to select a model or compute an estimation of ...</div><div class="ttdef"><b>Definition:</b> Validator.hpp:32</div></div>
<div class="ttc" id="classsann_1_1Validator_html_a6fc0173c2040d84a04cb83a64e5c3a52"><div class="ttname"><a href="classsann_1_1Validator.html#a6fc0173c2040d84a04cb83a64e5c3a52">sann::Validator::selectModel</a></div><div class="ttdeci">Network selectModel(const sann::dataSet &amp;tr, const sann::dataSet &amp;vs, sann::Estimator &amp;est) const</div><div class="ttdoc">Selects the best model using the parameters setted for the model selection. </div><div class="ttdef"><b>Definition:</b> Validator.cpp:296</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
